<!-- MODAL DE Ã‰XITO PERSONALIZADO -->
<div *ngIf="showSuccessModal" class="modal-show" style="z-index:9999;background:rgba(0,0,0,0.18);display:flex;align-items:center;justify-content:center;">
    <div style="background:#fff;padding:32px 36px 28px 36px;border-radius:16px;box-shadow:0 2px 16px rgba(0,0,0,0.10);text-align:center;min-width:320px;max-width:90vw;">
        <div style="font-size:48px;color:#10b981;margin-bottom:8px;">âœ”ï¸</div>
        <div style="font-size:22px;font-weight:600;margin-bottom:8px;">Â¡Tarea creada exitosamente!</div>
    </div>
</div>


<!-- MODAL -->
<div class="modal-show" (click)="close.emit()">
    <div class="modal-card" role="dialog" aria-modal="true"
             aria-labelledby="createTaskTitle"
             (click)="$event.stopPropagation()">

        <div class="modal-header">
            <div id="createTaskTitle"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-file-plus"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M14 3v4a1 1 0 0 0 1 1h4" /><path d="M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2" /><path d="M12 11l0 6" /><path d="M9 14l6 0" /></svg> Create New Task</div>
            <button class="button" (click)="Cerrar()">
  <span class="X"></span>
  <span class="Y"></span>
  <div class="close">Close</div>
</button>

        </div>

        <div class="modal-body">
            <form [formGroup]="form" (ngSubmit)="onSubmit()" style="display: flex; flex-direction: column; gap: 16px;">
                <div class="formulario">
                    <label>ğŸ“„ Task Name *</label>
                    <input type="text" formControlName="name" required style="width: 100%; padding: 8px; border: 1px solid #e2e8f0; border-radius: 6px;">
                </div>
                <div class="formulario">
                    <label>ğŸ“ Description</label>
                    <textarea formControlName="description" rows="3" style="width: 100%; padding: 8px; border: 1px solid #e2e8f0; border-radius: 6px;"></textarea>
                </div>
                <div class="formulario">
                    <label>ğŸ¢ Project</label>
                    <select formControlName="projectId" style="width: 100%; padding: 8px; border: 1px solid #e2e8f0; border-radius: 6px;">
                        <option value="">None</option>
                        <ng-container *ngFor="let p of projects">
                            <option [value]="p.id">{{ p.name }}</option>
                        </ng-container>
                    </select>
                </div>
                <div class="formulario">
                    <label> ğŸ”„ Phase</label>
                    <select formControlName="projectPhaseId" style="width: 100%; padding: 8px; border: 1px solid #e2e8f0; border-radius: 6px;">
                        <option value="">None / Select project first</option>
                        <ng-container *ngFor="let ph of phases">
                            <option [value]="ph.id">{{ ph.phase || ('Phase ' + ph.id) }}</option>
                        </ng-container>
                    </select>
                </div>
                <div class="formulario">
                    <label>ğŸ—‚ï¸ Category *</label>
                    <select formControlName="taskCategoryId" required style="width: 100%; padding: 8px; border: 1px solid #e2e8f0; border-radius: 6px;">
                        <option value="">Select Category</option>
                        <ng-container *ngFor="let c of categories">
                            <option [value]="c.id">{{ c.name }}</option>
                        </ng-container>
                    </select>
                </div>
                <div class="formulario">
                    <label>ğŸ“… Start Date (Issue Date)</label>
                    <input type="date" formControlName="issuedDate" style="width: 100%; padding: 8px; border: 1px solid #e2e8f0; border-radius: 6px;">
                </div>
                <div class="formulario" *ngIf="showEndDate">
                    <label>ğŸ“…âœ”ï¸ End Date (Vacations Only)</label>
                    <input type="date" formControlName="endDate" style="width: 100%; padding: 8px; border: 1px solid #e2e8f0; border-radius: 6px;">
                    <small style="color: #64748b; font-size: 12px;">Tasks will be created for each day in the range</small>
                </div>
                <div class="formulario">
                    <label>ğŸŸ¢ Status *</label>
                    <select formControlName="status" required style="width: 100%; padding: 8px; border: 1px solid #e2e8f0; border-radius: 6px;">
                        <ng-container *ngFor="let s of statuses">
                            <option [value]="s">{{ s }}</option>
                        </ng-container>
                    </select>
                </div>
                <div class="modal-footer">
                    <div class="botones-fin">
                        <button type="button" class="btn-cerrar" (click)="Cerrar()">
                            <span class="icon">âŒ</span> Cancel
                        </button>
                        <button type="submit" class="btn-create" [disabled]="form.invalid">
                            <span class="icon">ğŸ“</span> Create Task
                        </button>
                        
                    </div>
                    <div id="create-task-message" class="muted" [style.color]="messageColor" style="text-align:center; margin-top:8px;">{{ message }}</div>
                </div>
            </form>
        </div>

    </div>
</div>
