<div class="subtask-edit-modal-overlay" (click)="cancel()">
  <div class="subtask-edit-modal" style="max-width:640px;" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <div class="modal-title"><app-file-pen-icon [size]="35"></app-file-pen-icon> <span>Edit Report</span></div>
      <button class="modal-close" (click)="cancel()"><app-x-icon [size]="33" [color]="'red'"><div class="close">Close</div></app-x-icon></button>
    </div>

    <div class="modal-body">
      <form [formGroup]="form">
        <div class="form-group">
          <label for="edit-project">ğŸ“‹ Project</label>
          <input id="edit-project" name="projectId" type="text" [value]="projectLabel" class="form-input" disabled>
        </div>

        <div class="form-group">
          <label for="edit-category">ğŸ“‚ Category</label>
          <select id="edit-category" name="subTaskCategoryId" formControlName="subTaskCategoryId" class="form-input" autocomplete="off">
            <option *ngFor="let c of filteredCategories" [value]="c.id">{{c.name}}</option>
          </select>
          <div class="field-error" *ngIf="form.get('subTaskCategoryId')?.touched && form.get('subTaskCategoryId')?.invalid">Category is required</div>
        </div>

        <div class="form-group full-row">
          <label for="edit-name">âœï¸ Description</label>
          <textarea id="edit-name" name="name" formControlName="name" class="form-input" rows="2" placeholder="Describe the task..." autocomplete="off"></textarea>
          <div class="field-error" *ngIf="form.get('name')?.touched && form.get('name')?.invalid">Description is required</div>
        </div>

        <div style="display:grid; grid-template-columns:1fr 1fr; gap:12px;">
          <div class="form-group">
            <label for="edit-hours">â° Time Worked</label>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px;">
              <div>
                <input id="edit-hours" name="hours" type="number" formControlName="hours" min="0" class="form-input" autocomplete="off" style="text-align: center;">
                <small style="display: block; text-align: center; color: #666; margin-top: 2px;">Hours</small>
              </div>
              <div>
                <input id="edit-minutes" name="minutes" type="number" formControlName="minutes" min="0" max="59" class="form-input" autocomplete="off" style="text-align: center;">
                <small style="display: block; text-align: center; color: #666; margin-top: 2px;">Minutes</small>
              </div>
            </div>
          </div>
          <div class="field-error" *ngIf="(form.get('hours')?.touched || form.get('minutes')?.touched) && (form.get('hours')?.errors || form.get('minutes')?.errors)">
            <div *ngIf="form.get('hours')?.errors?.['required'] || form.get('minutes')?.errors?.['required']">Time is required</div>
            <div *ngIf="form.get('minutes')?.errors?.['max']">Minutes must be less than 60</div>
          </div>
          <div class="form-group">
            <label for="edit-date">ğŸ“… Date</label>
            <input id="edit-date" name="issueDate" type="date" formControlName="issueDate" class="form-input" autocomplete="off">
            <div class="field-error" *ngIf="form.get('issueDate')?.touched && form.get('issueDate')?.errors">
              <div *ngIf="form.get('issueDate')?.errors?.['required']">Date is required</div>
              <div *ngIf="form.get('issueDate')?.errors?.['weekend']">Weekends are not allowed</div>
            </div>
          </div>
        </div>

        <div class="form-group">
          <label for="edit-tag">ğŸ·ï¸ Tag</label>
          <select id="edit-tag" name="tag" formControlName="tag" class="form-input" autocomplete="off">
            <option value="">None</option>
            <option value="FIRE_PROTECTION">ğŸ”¥ Fire Protection</option>
            <option value="PEER_REVIEW">ğŸ‘ï¸ Peer Review</option>
          </select>
        </div>
      </form>

      <div class="form-group">
        <label>ğŸ‘¤ Created by</label>
        <input type="text" class="form-input" [value]="subtask?.createdByEmployeeName || ''" disabled>
      </div>

    </div>

    <div class="modal-footer">
    
        <button type="button" class="delete-button" [title]="'Remove'" (click)="deleteSubtask()">
      <svg class="delete-svgIcon" viewBox="0 0 448 512">
                    <path d="M135.2 17.7L128 32H32C14.3 32 0 46.3 0 64S14.3 96 32 96H416c17.7 0 32-14.3 32-32s-14.3-32-32-32H320l-7.2-14.3C307.4 6.8 296.3 0 284.2 0H163.8c-12.1 0-23.2 6.8-28.6 17.7zM416 128H32L53.2 467c1.6 25.3 22.6 45 47.9 45H346.9c25.3 0 46.3-19.7 47.9-45L416 128z"></path>
                  </svg>
    </button>

        <!-- <button class="delete-button"  (clicked)="deleteSubtask()">
  			<svg class="delete-svgIcon" viewBox="0 0 448 512">
                    <path d="M135.2 17.7L128 32H32C14.3 32 0 46.3 0 64S14.3 96 32 96H416c17.7 0 32-14.3 32-32s-14.3-32-32-32H320l-7.2-14.3C307.4 6.8 296.3 0 284.2 0H163.8c-12.1 0-23.2 6.8-28.6 17.7zM416 128H32L53.2 467c1.6 25.3 22.6 45 47.9 45H346.9c25.3 0 46.3-19.7 47.9-45L416 128z"></path>
                  </svg>
			</button> -->



        <!-- <app-icon-button title="Save" (clicked)="saveChanges()">
          <app-file-check-icon [size]="25"></app-file-check-icon>
        </app-icon-button> -->

  <div class="tooltip">
        <button class="action_has has_saved" aria-label="save" type="submit" (click)="saveChanges()">
            <svg
    aria-hidden="true"
    xmlns="http://www.w3.org/2000/svg"
    width="20"
    height="20"
    stroke-linejoin="round"
    stroke-linecap="round"
    stroke-width="2"
    viewBox="0 0 24 24"
    stroke="currentColor"
    fill="none"
  >
    <path
      d="m19,21H5c-1.1,0-2-.9-2-2V5c0-1.1.9-2,2-2h11l5,5v11c0,1.1-.9,2-2,2Z"
      stroke-linejoin="round"
      stroke-linecap="round"
      data-path="box"
    ></path>
    <path
      d="M7 3L7 8L15 8"
      stroke-linejoin="round"
      stroke-linecap="round"
      data-path="line-top"
    ></path>
    <path
      d="M17 20L17 13L7 13L7 20"
      stroke-linejoin="round"
      stroke-linecap="round"
      data-path="line-bottom"
    ></path>
  </svg>
            </button>
            <span class="tooltip-text">Save Changes</span>
            </div>

    </div>
  </div>
</div>
