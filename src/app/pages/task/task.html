<app-header></app-header>
<app-submenu></app-submenu>

  <div
    class="filter-search">
<div class="task-container">
  <section class="title-filters">
    <div class="header-with-button">
      <h1>Tasks</h1>

    <div *ngIf="isAdminOrOwner">
    <p class="texto-descriptivo">
 This page allows you to create and manage tasks associated with each area of â€‹â€‹the project, facilitating the organization and tracking of daily work.
 <br>
Tasks are displayed on a weekly calendar, appearing on the corresponding day according to their creation date, providing a clear overview of progress and workload.
<br>
Owners and Administrators can edit any task, ensuring total supervision and control of the process.</p>
</div>


<div *ngIf="isUserOnly">
  <p class="texto-descriptivo">
    This page allows you to create and manage tasks associated with each area of â€‹â€‹the project, facilitating the organization and tracking of daily work.
    <br>
Tasks are displayed on a weekly calendar, appearing on the corresponding day according to their creation date, providing a clear overview of progress and workload.
<br>
Users can only edit tasks they themselves have created, maintaining individual responsibility without affecting the work of others.
  </p>

</div>
  


    </div>
    <!-- Search -->
    <div class="filter-search">
      <label>Search</label>
      <input
        type="text"
        id="project-search"
        class="search-input"
        placeholder="ðŸ” Search tasks by project, code, client or task name..."
      />
    </div>
    <!-- Project, Category, Created by, Week, created by me-->
    <div class="filters-container">
      <div class="filter-group" style="min-width: 150px;">
        <label>Project</label>
        <select id="project-filter" class="project-select" style="width: 100%;">
          <option value="">All</option>
        </select>
      </div>
      <div class="filter-group" style="min-width: 150px;">
        <label>Category</label>
        <select id="category-filter" class="project-select" style="width: 100%;">
          <option value="">All</option>
        </select>
      </div>
      <div class="filter-group" style="min-width: 150px;">
        <label>Created by</label>
        <select id="creator-filter" class="project-select" style="width: 100%;">
          <option value="">All</option>
        </select>
      </div>
      <div class="filter-week" style="min-width: 150px;">
        <label>Week</label>
        <input
          type="week"
          id="week-filter"
          class="search-input"/>
      </div>
    </div>
    
    
    <div class="filters-actions-row">
       <div class="filter-created-by-me" style="display: flex; align-items: center; gap: 8px;">
          <input type="checkbox" id="created-by-me" (click)="onShowCreatedByMeChange($event)" style="margin:0;">
          <label for="created-by-me" style="margin:0;">Show created by me</label>
        </div>


      <div class="filter-show" style="display: flex; align-items: center; gap: 8px;">
        <input type="checkbox" id="mine-only-filter" (change)="onFilterChange()" style="margin:0;" />
        <label for="mine-only-filter" style="margin:0;">Show only my assigned projects</label>
      </div>
      <div class="top-right-buttons">
        <!-- <button id="clear-all-filters" class="btn btn-secondary btn-sm">
          Clear All Filters
        </button> -->
<button id="clear-all-filters" class="btn-clear-filters" type="button" >Clear All filters</button>

<div class="tooltip">
<button type="button" class="button3" (click)="showCreateTaskModal = true">
  <span class="button__text">Create New Task</span>
  <span class="button__icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" viewBox="0 0 24 24" stroke-width="2" stroke-linejoin="round" stroke-linecap="round" stroke="currentColor" height="24" fill="none" class="svg"><line y2="19" y1="5" x2="12" x1="12"></line><line y2="12" y1="12" x2="19" x1="5"></line></svg></span>
</button>
<span class="tooltip-text">Create a task and view it on the calendar</span>
</div>
      </div>
    </div>  
  </section>

  



  
  <section class="schedule">
    <section class="etiquetas">
    <!-- Calendar Legend will be rendered here -->
    <div id="calendar-legend-container"></div>
 
    <h2>ðŸ“Œ Schedule</h2>
    <app-create-task-card 
      *ngIf="showCreateTaskModal" 
      (close)="showCreateTaskModal = false">
    </app-create-task-card>
<app-edit-task
  *ngIf="tareaSeleccionada"
  [task]="tareaSeleccionada"
  [canEditTask]="canEditTask"
  [canDeleteTask]="canDeleteTask"
  [allProjects]="editTaskProjects"
  [categories]="editTaskCategories"
  [employees]="editTaskEmployees"
  (close)="tareaSeleccionada = null">
</app-edit-task>

    <div id="calendar-message" style="display:none;color:#e11d48;font-weight:600;margin:24px 0;text-align:center;"></div>
    <app-calendar-task #calendarTaskRef id="main-calendar" [tasks]="tasks"></app-calendar-task>
    <!-- Mine only -->
    <!-- <div class="by-me" ><label>Show created by me</label>
      <input type="checkbox" id="mine-only-filter"/>
    </div> -->
  </section>
   </section>



  <section class="schedule2">
    <br>
    <app-prev-icon [size]="37" color="red" [strokeWidth]="3"></app-prev-icon> <span>Schedule Prev</span> 
    <!--aqui va la etiqueta de el calendario week prev-->
    <app-calendar-week-prev #calendarWeekPrevRef [tasks]="tasks">


    </app-calendar-week-prev>
  </section>
</div>

<!-- Modal de confirmaciÃ³n para eliminar tarea -->
<app-confirm-modal 
  *ngIf="showDeleteConfirmModal"
  message="Are you sure you want to delete this task? This will also delete all associated subtasks."
  confirmText="Delete"
  cancelText="Cancel"
  (confirm)="confirmDeleteTask()"
  (cancel)="cancelDeleteTask()">
</app-confirm-modal>
    <!-- *ngIf="showCreateTaskModal"  -->
